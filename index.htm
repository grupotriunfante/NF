
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Entrada de NF</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        h1 {
            color: #0056b3;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }
        fieldset {
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        legend {
            font-size: 1.2em;
            font-weight: 600;
            color: #0056b3;
            padding: 0 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        input[type="text"],
        input[type="email"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; 
            font-size: 1em;
        }
        input[readonly] {
            background-color: #eee;
            color: #555;
            cursor: not-allowed;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        .btn-submit {
            background-color: #007bff;
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        .btn-submit:hover {
            background-color: #0056b3;
        }
        .campos-especificos {
            display: none;
            background-color: #f9f9f9;
            border: 1px dashed #ddd;
            padding: 20px;
            border-radius: 5px;
            margin-top: 15px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Formulário de Lançamento de Nota Fiscal</h1>
        <p>Preencha os campos abaixo para enviar a NF para lançamento pelo CPD.</p>

        <form id="formNF" name="formNF">

            <fieldset>
                <legend>1. Informações Gerais</legend>
                
                <div class="form-group">
                    <label for="codigoRegistro">Código de Registro (Automático):</label>
                    <input type="text" id="codigoRegistro" name="codigoRegistro" readonly>
                </div>

                <div class="form-group">
                    <label for="solicitante">Seu Nome (Solicitante):</label>
                    <input type="text" id="solicitante" name="solicitante" required>
                </div>

                <div class="form-group">
                    <label for="unidade">Unidade:</label>
                    <select id="unidade" name="unidade" required>
                        <option value="">-- Selecione a Unidade --</option>
                        <option value="ABC">ABC</option>
                        <option value="API">API</option>
                        <option value="TPH">TPH</option>
                        <option value="TCG">TCG</option>
                        <option value="MCD">MCD</option>
                        <option value="TBL">TBL</option>
                        <option value="TCV">TCV</option>
                        <option value="TBE">TBE</option>
                        <option value="TCA">TCA</option>
                        <option value="TSJ">TSJ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="numeroNF">Número da NF:</label>
                    <input type="text" id="numeroNF" name="numeroNF" required>
                </div>

                <div class="form-group">
                    <label for="anexoNF">Anexos da NF (Segure 'Ctrl' para selecionar vários):</label>
                    <input type="file" id="anexoNF" name="anexoNF" accept="image/*,.pdf,.xml" required multiple>
                </div>
            </fieldset>

            <fieldset>
                <legend>2. Tipo de Lançamento</legend>
                <div class="form-group">
                    <label for="tipoNF">Selecione o Tipo de NF:</label>
                    <select id="tipoNF" name="tipoNF" onchange="mostrarCampos()" required>
                        <option value="">-- Selecione uma opção --</option>
                        <option value="industria">1. NF Indústria</option>
                        <option value="devolucao">2. NF de Devolução</option>
                        <option value="troca">3. NF de Troca</option>
                        <option value="adm_servico">4. NF Administrativas/Serviços</option>
                        <option value="merchan">5. NF Merchan</option>
                    </select>
                </div>
            </fieldset>

            <fieldset>
                <legend>3. Detalhes Específicos</legend>
                <div id="camposDevolucao" class="campos-especificos">
                    <div class="form-group">
                        <label for="motivoDevolucao">Motivo da Devolução:</label>
                        <select id="motivoDevolucao" name="motivoDevolucao">
                            <option value="">-- Selecione o motivo --</option>
                            <option value="Cliente não Aceitou">1 - Cliente não Aceitou</option>
                            <option value="Cliente Fechado">2 - Cliente Fechado</option>
                            <option value="Produto faltando">3 - Produto faltando</option>
                        </select>
                    </div>
                </div>
                <div id="camposTroca" class="campos-especificos">
                    <div class="form-group">
                        <label for="authTroca">Autorização / Comentário (Ex: Validado pelo Comercial):</label>
                        <textarea id="authTroca" name="authTroca"></textarea>
                    </div>
                </div>
                <div id="camposMerchan" class="campos-especificos">
                    <div class="form-group">
                        <label for="codigosMerchan">Código dos Itens (Separar por vírgula ou um por linha):</label>
                        <textarea id="codigosMerchan" name="codigosMerchan"></textarea>
                    </div>
                </div>

                <div id="camposAdm" class="campos-especificos">
    
    <div class="form-group">
        <label for="operacaoFiscal">Operação Fiscal (digite o código ou nome para buscar):</label>
        <input type="text" id="operacaoFiscal" name="operacaoFiscal" list="listaOperacoesFiscais" placeholder="Digite o código (ex: 1.96.10) ou nome...">
    </div>

    <div class="form-group">
        <label for="descCoordenador">Descrição para Coordenador (Orçamento):</label>
        <textarea id="descCoordenador" name="descCoordenador" placeholder="Descreva os detalhes do orçamento para o coordenador (o CPD fará o link)..."></textarea>
    </div>

    <datalist id="listaOperacoesFiscais">
        <option value="1.11.01 Entrada de Complemento de IPI/ICMS"></option>
        <option value="1.12.08 LANCAMENTO EFETUADA DE SIMPLES FATURAMENTO"></option>
        <option value="1.12.09 LANCAMENTO SIMPLES FATURAMENTO S/CAP"></option>
        <option value="1.12.10 Compras de Mercadoria Ref Importacao"></option>
        <option value="1.12.14 INDUSTRIALIZACAO EFETUADA POR OUTRA EMPRESA"></option>
        <option value="1.32.34 Dev. Mercadoria Emp. Simples"></option>
        <option value="1.91.01 Compra Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="1.91.02 Compra Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="1.91.03 Compra Ativo Imobilizado (Veiculos)"></option>
        <option value="1.91.04 Compra Ativo Imobilizado (Instalacoes)"></option>
        <option value="1.91.05 Compra Ativo Imobilizado (Equip Comunicacao)"></option>
        <option value="1.92.01 Transf.Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="1.92.02 Transf.Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="1.92.05 Entrada Atv.Imob.Terc.P/uso Estabelecimento"></option>
        <option value="1.95.01 Retorno de Remessa p/Venda For a do Estab."></option>
        <option value="1.96.01 Serv. Frete Sobre Compras Ativo Imobilizado"></option>
        <option value="1.96.10 Cpas Combustives e Lubrificantes"></option>
        <option value="1.96.11 Cpas de Medicamentos"></option>
        <option value="1.96.12 Cpas Copa/Cozinha e Material de Limpeza"></option>
        <option value="1.96.14 Cpas Processamento/Manutencao de Dados"></option>
        <option value="1.96.18 Cpas Instalacoes"></option>
        <option value="1.96.20 Cpas Viagens e Estadias"></option>
        <option value="1.96.22 Cpas Manutencao Maquinas/Equip(moveis/utensi)"></option>
        <option value="1.96.24 Cpas Manutencao de Veiculos"></option>
        <option value="1.96.26 Cpas Impressos e Material de Escritorio"></option>
        <option value="1.96.28 Cpas Propaganda e Publicidade"></option>
        <option value="1.96.30 Cpas Terceiro Pessoa Juridica"></option>
        <option value="1.96.34 Cpas Copias/Encadernacoes/Impressoes"></option>
        <option value="1.96.36 Cpas Uniformes/Equipamentos e Protecao"></option>
        <option value="1.96.38 Cpas Materiais Merchandising"></option>
        <option value="1.96.44 Cpas Frete Sobre Compras"></option>
        <option value="1.96.45 Cpas Frete Sobre Compras Ativo Imobilizado"></option>
        <option value="1.96.46 Cpas Assistencia Medica e Social"></option>
        <option value="1.96.48 Cpas Telefone / Celular / Tablets / Notebooks"></option>
        <option value="1.96.50 Cpas Cargas e Descargas"></option>
        <option value="1.96.52 Cpas Confraternizacoes"></option>
        <option value="1.96.56 Cpas Maq/Equipamentos"></option>
        <option value="1.96.58 Cpas Fretes / Carretos"></option>
        <option value="1.96.60 Cpas P/ Reunioes"></option>
        <option value="1.96.62 Cpas Vale Transporte"></option>
        <option value="1.96.64 Cpas Cursos/Treinamentos"></option>
        <option value="1.96.68 Cpas Alimentos / Bebidas"></option>
        <option value="1.96.70 Cpas Funerais"></option>
        <option value="1.96.72 Cpas de Embalagens"></option>
        <option value="1.96.74 Cpas P/ Manutencao de Frota"></option>
        <option value="1.96.76 Cpas Premiacoes"></option>
        <option value="1.96.78 Cpas Material Robo"></option>
        <option value="1.96.88 Cpas Serv Comunicacao"></option>
        <option value="1.96.90 Cpas Refeicoes"></option>
        <option value="1.96.96 Cpas Plano Odontologico"></option>
        <option value="1.97.01 Compra de Material de Uso e Consumo"></option>
        <option value="1.97.30 Serv S/RET Terceiro Pessoa Juridica"></option>
        <option value="1.98.02 Serv Eventos"></option>
        <option value="1.98.13 Serv Honorarios S/ Cobranca"></option>
        <option value="1.98.14 Serv Processamento/Manutencao de Dados"></option>
        <option value="1.98.15 Serv Recrutamento e Selecao"></option>
        <option value="1.98.16 Serv Vale Refeicao"></option>
        <option value="1.98.17 Serv Medicamentos"></option>
        <option value="1.98.18 Serv Instalacoes"></option>
        <option value="1.98.19 Serv Auxilio Mobilidade"></option>
        <option value="1.98.20 Serv Viagens e Estadias"></option>
        <option value="1.98.21 Serv Auditoria Contabil"></option>
        <option value="1.98.22 Serv Manutencao Maquinas/Equip(moveis/utensi)"></option>
        <option value="1.98.23 Serv Vale Alimentacao"></option>
        <option value="1.98.24 Serv Manutencao de Veiculos"></option>
        <option value="1.98.25 Serv Adiantamento Colaborador"></option>
        <option value="1.98.26 Serv Impressos e Material de Escritorio"></option>
        <option value="1.98.27 Serv Software"></option>
        <option value="1.98.28 Serv Propaganda e Publicidade"></option>
        <option value="1.98.29 Serv Certificado Digital"></option>
        <option value="1.98.30 Serv Terceiro Pessoa Juridica"></option>
        <option value="1.98.31 Serv Feira / Exposicao"></option>
        <option value="1.98.33 Serv Robo"></option>
        <option value="1.98.34 Serv Copias/Encadernacoes/Impressoes"></option>
        <option value="1.98.35 Serv Manutencao de Frota"></option>
        <option value="1.98.36 Serv Uniformes/Equipamentos e Protecao"></option>
        <option value="1.98.37 Serv KM Rodado"></option>
        <option value="1.98.39 Serv Internet"></option>
        <option value="1.98.40 Serv Locacao de Mao de Obra"></option>
        <option value="1.98.41 Serv Taxa Cartao"></option>
        <option value="1.98.42 Serv Cesta Basica"></option>
        <option value="1.98.43 Serv Telefonia"></option>
        <option value="1.98.44 Serv Frete Sobre Compras"></option>
        <option value="1.98.45 Serv Agenciamento Viagem"></option>
        <option value="1.98.46 Serv Assitencia Medica e Social"></option>
        <option value="1.98.47 Serv Agenciamento Comercial"></option>
        <option value="1.98.48 Serv Telefone / Celular / Tablets / Notebooks"></option>
        <option value="1.98.49 Serv de Licenciamento Ambiental"></option>
        <option value="1.98.50 Serv Estacionamentos"></option>
        <option value="1.98.51 Serv Vigilancia Sanitaria"></option>
        <option value="1.98.52 Serv Confraternizacoes"></option>
        <option value="1.98.53 Serv Intermedicao - Distratos"></option>
        <option value="1.98.54 Serv Comissoes S/ Vendas"></option>
        <option value="1.98.55 Serv Coleta de Mercadorias Improprias"></option>
        <option value="1.98.56 Serv Aluguel Maq/Equipamentos"></option>
        <option value="1.98.58 Serv Fretes / Carretos"></option>
        <option value="1.98.60 Serv Despesas C/ Reunioes"></option>
        <option value="1.98.62 Serv Vale Transporte"></option>
        <option value="1.98.64 Serv Cursos e Treinamentos"></option>
        <option value="1.98.65 Serv Assessoria e Consultoria"></option>
        <option value="1.98.66 Serv Honorarios Contabeis"></option>
        <option value="1.98.67 Serv Honorarios"></option>
        <option value="1.98.68 Serv Despesas C/ Refeicoes"></option>
        <option value="1.98.70 Serv Despesas Com Funerais"></option>
        <option value="1.98.74 Serv Fretes Sobre Vendas / Armazenagem"></option>
        <option value="1.98.76 Serv de Premios"></option>
        <option value="1.98.78 Serv Compra Vale Combustivel"></option>
        <option value="1.98.80 Serv Merchandising"></option>
        <option value="1.98.82 Serv Cargas e Descargas"></option>
        <option value="1.98.84 Serv Royalties"></option>
        <option value="1.98.86 Serv Indenizacao"></option>
        <option value="1.98.88 Serv Comunicacao"></option>
        <option value="1.98.90 Serv Honorarios Advocaticios"></option>
        <option value="1.98.92 Serv de Anuncios"></option>
        <option value="1.98.94 Serv Despesas Cartorarias"></option>
        <option value="1.98.96 Serv Plano Odontologico"></option>
        <option value="1.98.98 Serv Seguranca/Monitoramento"></option>
        <option value="1.99.01 Mercadoria Recebida em Bonificacao"></option>
        <option value="1.99.03 Brindes Sem Cap"></option>
        <option value="1.99.04 Simples Remessa"></option>
        <option value="1.99.05 Simples Remessa Ativo Imobilizado"></option>
        <option value="1.99.06 Retorno de Vendas em Consignacao"></option>
        <option value="1.99.07 Simples Remessa - Comodato"></option>
        <option value="1.99.08 Simples Remessa - Ret. Simbolico Armazem Gera"></option>
        <option value="1.99.09 Entrada de Bem de Comodato"></option>
        <option value="1.99.13 Retorno Merc./Bem p/Demonstracao"></option>
        <option value="1.99.14 Retorno Merc./Bem Remetido p/Exposicao/Feira"></option>
        <option value="1.99.15 Retorno Mercadoria/Bem Rec.do Conserto/Reparo"></option>
        <option value="1.99.16 Entrada por C/E Ordem"></option>
        <option value="1.99.17 Entrada P/ Ind. Por Conta Adquirente"></option>
        <option value="1.99.18 RETORNO MERC.REMETIDA P/ INDUSTR."></option>
        <option value="1.99.19 RETORNO SIMBOLICO DE MERC.REMET.P/DEP.FECHADO"></option>
        <option value="1.99.20 Mercadoria Recebida em Consignacao"></option>
        <option value="1.99.21 Entrada material/carcaca p/destinacao final"></option>
        <option value="1.99.22 Amostra Gratis"></option>
        <option value="1.99.25 Compra Pallet Unidades"></option>
        <option value="1.99.26 Remessa Importacao Robo"></option>
        <option value="1.99.31 Energia Eletrica"></option>
        <option value="1.99.33 Compras Promocao De Vendas"></option>
        <option value="1.99.35 Manutencao de Frota"></option>
        <option value="1.99.36 Combustiveis e Lubrificantes Frota Propria"></option>
        <option value="1.99.40 Entrada de Vasilhame ou Sacaria"></option>
        <option value="1.99.41 Retorno de Vasilhame ou Sacaria"></option>
        <option value="1.99.42 Entrada por Venda A Ordem"></option>
        <option value="1.99.43 Entrada de Armazenagem"></option>
        <option value="1.99.45 Entrada de Vasilhame ou Sacaria"></option>
        <option value="1.99.51 Fretes Sobre Vendas / Armazenagem"></option>
        <option value="1.99.52 Entrada em decorrencia de mudanca de endereco"></option>
        <option value="1.99.56 Locacao de Maquinas e Equipamentos"></option>
        <option value="1.99.61 Compra de Brindes Com Cap"></option>
        <option value="1.99.62 Compras de Material Promocional"></option>
        <option value="1.99.65 Entrada de Merc. P/Demonstracao"></option>
        <option value="1.99.67 Entrada de Material Promocional sem CAP"></option>
        <option value="1.99.70 Compra de Brindes SEM SOMAR ESTOQUE"></option>
        <option value="1.99.71 Remessa p/Degustacao"></option>
        <option value="1.99.80 Energia Eletrica S/ CAP"></option>
        <option value="1.99.81 Fretes Sobre Vendas S/ CAP"></option>
        <option value="1.99.82 Outras Entradas - Conta e Ordem de Terceiros"></option>
        <option value="1.99.83 COMPRA P/ COMERC. ORIG. ENCOM. P/ RECEB. FUTU"></option>
        <option value="1.99.84 COMPRA P/ COMERC. ORIG. ENCOM. P/ RECEB. FUTU"></option>
        <option value="1.99.90 ADJUDICACAO DE IMPOSTO PROPRIO"></option>
        <option value="1.99.91 Diferenca de ICMS"></option>
        <option value="1.99.92 Dev. Ressarcimento ICMS Retido por Subst.Trib"></option>
        <option value="1.99.93 Dev. cliente baixado na sefaz"></option>
        <option value="1.99.95 Sobra Mercadorias"></option>
        <option value="1.99.96 Entrada Por Ajuste de Inventario"></option>
        <option value="1.99.98 Entrada Por Reclassificacao"></option>
        <option value="2.11.01 Entrada de Complemento de IPI/ICMS"></option>
        <option value="2.12.01 Compras de Mercadorias p/Rev."></option>
        <option value="2.12.03 Compras de Mercadorias de Unidades"></option>
        <option value="2.12.04 Compras de Mercadorias SCJ AM"></option>
        <option value="2.12.07 COMPRA P/INDUSTR.MERC.REMITIDA PELO FORNECEDO"></option>
        <option value="2.12.08 LANCAMENTO SIMPLES FATURAMENTO C/CAP"></option>
        <option value="2.12.09 LANCAMENTO SIMPLES FATURAMENTO S/CAP"></option>
        <option value="2.12.10 Compras de Mercadorias Ref Importacao"></option>
        <option value="2.12.14 INDUSTRIALIZACAO EFETUADA POR OUTRA EMPRESA"></option>
        <option value="2.32.34 Dev. Mercadoria Emp. Simples"></option>
        <option value="2.63.01 Fretes Sobre Compras"></option>
        <option value="2.91.01 Compra Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="2.91.02 Compra Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="2.91.03 Compra Ativo Imobilizado (Veiculos)"></option>
        <option value="2.91.04 Compra Ativo Imobilizado (Instalacoes)"></option>
        <option value="2.91.05 Compra Ativo Imobilizado (Equip Comunicacao)"></option>
        <option value="2.92.01 Transf.Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="2.92.02 Transf.Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="2.92.05 Entrada Atv.Imob.Terc.P/uso Estabelecimento"></option>
        <option value="2.95.01 Retorno de Remessa p/Venda For a do Estab."></option>
        <option value="2.96.01 Serv. Frete Sobre Compras Ativo Imobilizado"></option>
        <option value="2.96.10 Cpas Combustives e Lubrificantes"></option>
        <option value="2.96.11 Cpas de Medicamentos"></option>
        <option value="2.96.12 Cpas Copa/Cozinha e Material de Limpeza"></option>
        <option value="2.96.14 Cpas Processamento/Manutencao de Dados"></option>
        <option value="2.96.18 Cpas Instalacoes"></option>
        <option value="2.96.20 Cpas Viagens e Estadias"></option>
        <option value="2.96.22 Cpas Manutencao Maquinas e Equipamentos"></option>
        <option value="2.96.24 Cpas Manutencao de Veiculos"></option>
        <option value="2.96.26 Cpas Impressos e Material de Escritorio"></option>
        <option value="2.96.28 Cpas Propaganda e Publicidade"></option>
        <option value="2.96.30 Cpas Terceiro Pessoa Juridica"></option>
        <option value="2.96.34 Cpas Copias/Encadernacoes/Impressoes"></option>
        <option value="2.96.36 Cpas Uniformes/Equipamentos e Protecao"></option>
        <option value="2.96.38 Cpas Materiais Merchandising"></option>
        <option value="2.96.44 Cpas Frete Sobre Compras"></option>
        <option value="2.96.45 Cpas Frete Sobre Compras Ativo Imobilizado"></option>
        <option value="2.96.46 Cpas Assistencia Medica e Social"></option>
        <option value="2.96.48 Cpas Telefone / Celular / Tablets / Notebooks"></option>
        <option value="2.96.50 Cpas Cargas e Descargas"></option>
        <option value="2.96.52 Cpas Confraternizacoes"></option>
        <option value="2.96.56 Cpas Maq/Equipamentos"></option>
        <option value="2.96.58 Cpas Fretes / Carretos"></option>
        <option value="2.96.60 Cpas P/ Reunioes"></option>
        <option value="2.96.62 Cpas Vale Transporte"></option>
        <option value="2.96.64 Cpas Cursos/Treinamentos"></option>
        <option value="2.96.68 Cpas Alimentos / Bebidas"></option>
        <option value="2.96.70 Cpas Funerais"></option>
        <option value="2.96.72 Cpas de Embalagens"></option>
        <option value="2.96.74 Cpas P/ Manutencao de Frota"></option>
        <option value="2.96.76 Cpas Premiacoes"></option>
        <option value="2.96.78 Cpas Material Robo"></option>
        <option value="2.96.88 Cpas Serv Comunicacao"></option>
        <option value="2.96.90 Cpas Refeicoes"></option>
        <option value="2.96.96 Cpas Plano Odontologico"></option>
        <option value="2.97.01 Compra Material Uso/Consumo"></option>
        <option value="2.98.02 Serv Eventos"></option>
        <option value="2.98.10 Serv Combustives e Lubrificantes"></option>
        <option value="2.98.13 Serv Honorarios S/ Cobranca"></option>
        <option value="2.98.14 Serv Processamento/Manutencao de Dados"></option>
        <option value="2.98.15 Serv Recrutamento e Selecao"></option>
        <option value="2.98.16 Serv Vale Refeicao"></option>
        <option value="2.98.17 Serv Medicamentos"></option>
        <option value="2.98.18 Serv Instalacoes"></option>
        <option value="2.98.19 Serv Auxilio Mobilidade"></option>
        <option value="2.98.20 Serv Viagens e Estadias"></option>
        <option value="2.98.21 Serv Auditoria Contabil"></option>
        <option value="2.98.22 Serv Manutencao Maquinas/Equip(moveis/utensi)"></option>
        <option value="2.98.23 Serv Vale Alimentacao"></option>
        <option value="2.98.24 Serv Manutencao de Veiculos"></option>
        <option value="2.98.25 Serv Adiantamento Colaborador"></option>
        <option value="2.98.26 Serv Impressos e Material de Escritorio"></option>
        <option value="2.98.27 Serv Software"></option>
        <option value="2.98.28 Serv Propaganda e Publicidade"></option>
        <option value="2.98.29 Serv Certificado Digital"></option>
        <option value="2.98.30 Serv Terceiro Pessoa Juridica"></option>
        <option value="2.98.31 Serv Feira / Exposicao"></option>
        <option value="2.98.33 Serv Robo"></option>
        <option value="2.98.35 Serv Manutencao de Frota"></option>
        <option value="2.98.37 Serv KM Rodado"></option>
        <option value="2.98.38 Serv Merchandising"></option>
        <option value="2.98.39 Serv Internet"></option>
        <option value="2.98.40 Serv Locacao de Mao de Obra"></option>
        <option value="2.98.41 Serv Taxa Cartao"></option>
        <option value="2.98.42 Serv Cesta Basica"></option>
        <option value="2.98.43 Serv Telefonia"></option>
        <option value="2.98.44 Serv Frete Sobre Compras"></option>
        <option value="2.98.45 Serv Agenciamento Viagem"></option>
        <option value="2.98.46 Serv Assitencia Medica e Social"></option>
        <option value="2.98.47 Serv Agenciamento Comercial"></option>
        <option value="2.98.48 Serv Telefone / Celular / Tablets"></option>
        <option value="2.98.49 Serv de Licenciamento Ambiental"></option>
        <option value="2.98.50 Serv Estacionamentos"></option>
        <option value="2.98.51 Serv Vigilancia Sanitaria"></option>
        <option value="2.98.52 Serv Confraternizacoes"></option>
        <option value="2.98.53 Serv Intermedicao - Distratos"></option>
        <option value="2.98.54 Serv Comissoes S/ Vendas"></option>
        <option value="2.98.55 Serv Coleta de Mercadorias Improprias"></option>
        <option value="2.98.56 Serv Aluguel Maq/Equipamentos"></option>
        <option value="2.98.58 Serv Fretes / Carretos"></option>
        <option value="2.98.60 Serv Despesas C/ Reunioes"></option>
        <option value="2.98.64 Serv Cursos e Treinamentos"></option>
        <option value="2.98.65 Serv Assessoria e Consultoria"></option>
        <option value="2.98.66 Serv Honorarios Contabeis"></option>
        <option value="2.98.67 Serv Honorarios"></option>
        <option value="2.98.70 Serv Despesas Com Funerais"></option>
        <option value="2.98.72 Serv Compra Embalagens"></option>
        <option value="2.98.76 Serv de Premios"></option>
        <option value="2.98.78 Serv Compra Vale Combustivel"></option>
        <option value="2.98.80 Serv Merchandising"></option>
        <option value="2.98.82 Serv Cargas e Descargas"></option>
        <option value="2.98.84 Serv Royalties"></option>
        <option value="2.98.86 Serv Indenizacao"></option>
        <option value="2.98.88 Servico Comunicacao"></option>
        <option value="2.98.90 Serv Honorarios Advocaticios"></option>
        <option value="2.98.92 Serv Anuncios"></option>
        <option value="2.98.94 Serv Despesas Cartorarias"></option>
        <option value="2.98.96 Serv Plano Odontologico"></option>
        <option value="2.98.98 Serv Seguranca/Monitoramento"></option>
        <option value="2.99.01 Mercadoria Recebida em Bonificacao"></option>
        <option value="2.99.03 Brindes"></option>
        <option value="2.99.04 Simples Remessa"></option>
        <option value="2.99.05 Simples Remessa Ativo Imobilizado"></option>
        <option value="2.99.06 Retorno de Vendas em Consignacao"></option>
        <option value="2.99.08 Simples Remessa - Ret. Simbolico Dep.Fechado"></option>
        <option value="2.99.09 Entrada de Bem de Comodato"></option>
        <option value="2.99.13 Retorno Merc./Bem p/Demonstracao"></option>
        <option value="2.99.14 Retorno Merc./Bem Remetido p/Exposicao/Feira"></option>
        <option value="2.99.15 Retorno Mercadoria/Bem Rec.do Conserto/Reparo"></option>
        <option value="2.99.16 Entrada por C/E Ordem"></option>
        <option value="2.99.17 Entrada P/ Ind. Por Conta Adquirente"></option>
        <option value="2.99.18 RETORNO MERC.REMETIDA P/ INDUSTR."></option>
        <option value="2.99.20 Mercadoria Recebida em Consignacao"></option>
        <option value="2.99.21 Entrada material/carcaca p/destinacao final"></option>
        <option value="2.99.22 Amostra Gratis"></option>
        <option value="2.99.24 Compras De Bens Para Comodato"></option>
        <option value="2.99.25 Compra Pallet Unidades"></option>
        <option value="2.99.26 Remessa Importacao Robo"></option>
        <option value="2.99.31 Energia Eletrica"></option>
        <option value="2.99.33 Compras Promocao De Vendas"></option>
        <option value="2.99.35 Manutencao de Frota"></option>
        <option value="2.99.36 Combustiveis e Lubrificantes Frota Propria"></option>
        <option value="2.99.40 Entrada de Vasilhame ou Sacaria"></option>
        <option value="2.99.41 Retorno de Vasilhame ou Sacaria"></option>
        <option value="2.99.42 Entrada por Venda A Ordem"></option>
        <option value="2.99.43 Entrada por Bonificacao A ORDEM"></option>
        <option value="2.99.44 BONIF. P/INDUSTR.MERC.REMITIDA PELO FORNECEDO"></option>
        <option value="2.99.45 Entrada de Vasilhame ou Sacaria"></option>
        <option value="2.99.51 Fretes Sobre Vendas"></option>
        <option value="2.99.61 Compras de Brindes"></option>
        <option value="2.99.62 Compras de Material Promocional"></option>
        <option value="2.99.65 Entrada de merc. P/Demonstracao"></option>
        <option value="2.99.67 Entrada de Material Promocional sem CAP"></option>
        <option value="2.99.70 Compra de Brindes SEM SOMAR ESTOQUE"></option>
        <option value="2.99.71 Remessa p/Degustacao"></option>
        <option value="2.99.81 Fretes Sobre Compras S/ Cap"></option>
        <option value="2.99.82 Outras Entradas - Conta e Ordem de Terceiros"></option>
        <option value="2.99.83 COMPRA P/ COMERC. ORIG. ENCOM. P/ RECEB. FUTU"></option>
        <option value="2.99.84 COMPRA P/ COMERC. ORIG. ENCOM. P/ RECEB. FUTU"></option>
        <option value="2.99.90 ADJUDICACAO DE IMPOSTO PROPRIO"></option>
        <option value="2.99.91 Diferenca de ICMS/IPI"></option>
        <option value="2.99.92 Dev. Ressarcimento ICMS Retido por Subst.Trib"></option>
        <option value="2.99.95 Sobra Mercadorias"></option>
        <option value="2.99.99 Teste TI Somente ( NAO USAR )"></option>
        <option value="5.12.01 Vendas de Mercadorias"></option>
        <option value="5.12.03 Vendas de Mercadorias p/Unidades"></option>
        <option value="5.12.04 Venda Mercadorias P/EXPORTACAO"></option>
        <option value="5.12.08 Vendas Ecom Danone/Pharmalink ( TCA )"></option>
        <option value="5.12.09 ( SOMENTE TCA) Vendas de Mercadorias"></option>
        <option value="5.12.10 Vendas de Mercadorias - Orgaos Publicos"></option>
        <option value="5.12.12 Venda a nao Contribuinte"></option>
        <option value="5.12.13 Vdas. Merc. - Orgaos Publicos SEM CREDITO ST"></option>
        <option value="5.12.16 Vendas de Mercadorias SEM PASSAR WMS"></option>
        <option value="5.12.20 Vendas de Mercadorias - Entrega Futura Nf Ger"></option>
        <option value="5.12.21 Vendas de Mercadorias - Entrega Futura Nf Rem"></option>
        <option value="5.12.34 Vendas De Mercadoria - Emp. Simples"></option>
        <option value="5.12.91 Estorno de ICMS"></option>
        <option value="5.12.92 Baixa p/Consumo"></option>
        <option value="5.12.94 Baixa Industria P/ Consumo"></option>
        <option value="5.12.95 Vendas de Mercadorias Combo"></option>
        <option value="5.12.96 Baixa pra Uso e Consumo - Merchandising"></option>
        <option value="5.91.01 Venda Ativo Imoblizado (Moveis/Utens.)"></option>
        <option value="5.91.02 Venda Ativo Imoblizado (Maq./Equip.)"></option>
        <option value="5.91.03 Venda Ativo Imobilizado (Veiculos)"></option>
        <option value="5.91.04 Venda Ativo Imobilizado (Instalacoes)"></option>
        <option value="5.91.05 Venda Ativo Imobilizado (Equipamentos Comunc)"></option>
        <option value="5.92.01 Transf.Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="5.92.02 Transf.Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="5.92.05 Dev.Atv.Imob.Terc.Recebido uso Estabelec."></option>
        <option value="5.96.01 Remessa p/Venda Fora do Estabelecimento"></option>
        <option value="5.98.01 Anulacao De Valor De Prestacao De Servico"></option>
        <option value="5.99.01 Mercadorias Concedidas em Bonificacao DM"></option>
        <option value="5.99.03 Brindes C/C"></option>
        <option value="5.99.04 Simples Remessa"></option>
        <option value="5.99.05 Simples Remessa Ativo Imobilizado"></option>
        <option value="5.99.06 Vendas em Consignacao"></option>
        <option value="5.99.07 Simples Remessa - Comodato"></option>
        <option value="5.99.08 Simples Remessa - Armazem Geral"></option>
        <option value="5.99.10 Retorno Bem Recebido p/Contrato Comodato"></option>
        <option value="5.99.12 Remessa Merc./Bem p/Demonstracao"></option>
        <option value="5.99.13 Remessa de Amostra Gratis"></option>
        <option value="5.99.14 Remessa Merc./Bem p/Exposicao ou Feira"></option>
        <option value="5.99.15 Remessa Mercadoria/Bem p/Conserto/Reparo"></option>
        <option value="5.99.17 Descarte De Materiais De Merchandising"></option>
        <option value="5.99.18 Bonificacao de Mercadorias P/Exportacao"></option>
        <option value="5.99.20 Remessa material/carcaca p/destinacao final"></option>
        <option value="5.99.25 Venda Pallets Unidades"></option>
        <option value="5.99.33 Brindes DM"></option>
        <option value="5.99.34 Mercadorias Bonificadas Emp. Simples"></option>
        <option value="5.99.40 Remessa de Vasilhame ou Sacaria"></option>
        <option value="5.99.42 Remessa por Venda A Ordem"></option>
        <option value="5.99.45 Remessa de Vasilhame ou Sacaria"></option>
        <option value="5.99.51 Fretes Sobre Vendas"></option>
        <option value="5.99.52 Saida em decorrencia de mudanca de endereco"></option>
        <option value="5.99.67 Remessa de Material Promocional sem CAR"></option>
        <option value="5.99.71 Remessa p/Degustacao"></option>
        <option value="5.99.81 PRESTACAO SERVICO TRIBUTADO P/IMP.SERV.Q.NAT."></option>
        <option value="5.99.82 Saida por Ajuste de Inventario"></option>
        <option value="5.99.83 Saida por Perda/Avaria"></option>
        <option value="5.99.84 Saida por Perda/Validade"></option>
        <option value="5.99.85 Saida por Perda/Operacional"></option>
        <option value="5.99.90 Saida Merc. Inaproveitaveis Sem Vlr Comercial"></option>
        <option value="5.99.91 Diferenca de ICMS"></option>
        <option value="5.99.92 Ressarcimento ICMS Retido por Subst.Trib."></option>
        <option value="5.99.93 Diferenca de IPI"></option>
        <option value="5.99.94 REMESSA PARA INDUSTRIALIZACAO POR ENCOMENDA"></option>
        <option value="5.99.95 Saida p/perda,roubo, deterioracao IMPROPRIAS"></option>
        <option value="6.12.01 Vendas de Mercadorias"></option>
        <option value="6.12.03 Vendas de Mercadorias p/Unidades"></option>
        <option value="6.12.04 Venda Mercadorias P/EXPORTACAO"></option>
        <option value="6.12.07 Vendas Merc.Ja Cobrada Sub.Trib. UNIDADES"></option>
        <option value="6.12.12 Venda a nao Contribuinte"></option>
        <option value="6.12.34 Venda De Mercadoria - Emp. Simples"></option>
        <option value="6.12.94 Baixa Industria P/ Consumo"></option>
        <option value="6.55.41 Remessa Para Conserto - Ativo Imobilizado"></option>
        <option value="6.91.01 Venda Ativo Imoblizado (Moveis/Utens.)"></option>
        <option value="6.91.02 Venda Ativo Imoblizado (Maq./Equip.)"></option>
        <option value="6.91.03 Venda Ativo Imobilizado (Veiculos)"></option>
        <option value="6.91.04 Venda Ativo Imobilizado (Construcao)"></option>
        <option value="6.92.01 Transf.Ativo Imobilizado (Moveis/Utens.)"></option>
        <option value="6.92.02 Transf.Ativo Imobilizado (Maq./Equip.)"></option>
        <option value="6.92.05 Dev.Atv.Imob.Terc.Recebido uso Estabelec."></option>
        <option value="6.96.01 Remessa p/Venda Fora do Estabelecimento"></option>
        <option value="6.98.01 Anulacao De Valor De Prestacao De Servico"></option>
        <option value="6.99.01 Mercadorias Concedidas em Bonificacao DM"></option>
        <option value="6.99.03 Brindes C/C"></option>
        <option value="6.99.04 Simples Remessa"></option>
        <option value="6.99.05 Simples Remessa Ativo Imobilizado"></option>
        <option value="6.99.06 Vendas em Consignacao"></option>
        <option value="6.99.07 Simples Remessa - Comodato"></option>
        <option value="6.99.08 Simples Remessa - Deposito Fechado"></option>
        <option value="6.99.09 Remessa p/Industrializacao p/Encomenda"></option>
        <option value="6.99.10 Retorno Bem Recebido p/Contrato Comodato"></option>
        <option value="6.99.11 Outras Saidas Merc/Servicos nao Especificada"></option>
        <option value="6.99.12 Remessa Merc./Bem p/Demonstracao"></option>
        <option value="6.99.13 Remessa de Amostra Gratis"></option>
        <option value="6.99.14 Remessa Merc./Bem p/Exposicao ou Feira"></option>
        <option value="6.99.15 Remessa Merc./Bem P/Conserto ou Reparo"></option>
        <option value="6.99.18 Bonificacao de Mercadorias P/Exportacao"></option>
        <option value="6.99.20 Remessa material/carcaca p/destinacao final"></option>
        <option value="6.99.22 Mercadorias Concedidas em Bonificacao C/C"></option>
        <option value="6.99.25 Venda Pallets Unidades"></option>
        <option value="6.99.33 Brindes DM"></option>
        <option value="6.99.34 Mercadorias Bonificadas Emp. Simples"></option>
        <option value="6.99.40 Remessa de Vasilhame ou Sacaria"></option>
        <option value="6.99.42 Remessa por Venda A Ordem"></option>
        <option value="6.99.45 Remessa de Vasilhame ou Sacaria"></option>
        <option value="6.99.67 Remessa de Material Promocional sem CAR"></option>
        <option value="6.99.71 Remessa p/Degustacao"></option>
        <option value="6.99.90 Saida Merc. Inaproveitaveis Sem Vlr Comercial"></option>
        <option value="6.99.91 Diferenca de ICMS"></option>
        <option value="6.99.92 Ressarcimento ICMS Retido por Subst.Trib."></option>
        <option value="6.99.93 Diferenca de IPI"></option>
    </datalist>
</div>

            </fieldset>

            <button type="submit" class="btn-submit">Enviar para Lançamento</button>

        </form>
    </div>

    <script>
        // Script 1: Gerador de Código de Registro
        document.addEventListener('DOMContentLoaded', function() {
            function pad(num) {
                return num < 10 ? '0' + num : num;
            }
            const d = new Date();
            const ano = d.getFullYear();
            const mes = pad(d.getMonth() + 1); 
            const dia = pad(d.getDate());
            const hora = pad(d.getHours());
            const min = pad(d.getMinutes());
            const seg = pad(d.getSeconds());

            const codigo = `NF-${ano}${mes}${dia}-${hora}${min}${seg}`;
            document.getElementById('codigoRegistro').value = codigo;
        });

        // Script 2: Mostrar Campos (ATUALIZADO com 'adm_servico')
        function mostrarCampos() {
            var divs = document.querySelectorAll('.campos-especificos');
            divs.forEach(function(div) {
                div.style.display = 'none';
            });

            var valor = document.getElementById('tipoNF').value;

            if (valor === 'devolucao') {
                document.getElementById('camposDevolucao').style.display = 'block';
            } 
            else if (valor === 'troca') { 
                document.getElementById('camposTroca').style.display = 'block';
            }
            else if (valor === 'merchan') {
                document.getElementById('camposMerchan').style.display = 'block';
            }
            // MUDANÇA AQUI
            else if (valor === 'adm_servico') { 
                document.getElementById('camposAdm').style.display = 'block';
            }
        }

        // Script 3: Envio do Formulário (ATUALIZADO para múltiplos arquivos e novos campos)
        const form = document.getElementById('formNF');
        form.addEventListener('submit', async function(e) {
            e.preventDefault(); 

            const submitButton = form.querySelector('.btn-submit');
            submitButton.disabled = true;
            submitButton.textContent = 'Enviando, aguarde...';

            // ATENÇÃO: Cole sua URL do Power Automate aqui
            const flowUrl = "https://defaultaf73075ee5864d09b8b3d44b758089.52.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/3a0d140e5acc4e259dc83b36923f117c/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=Qn_YOdIgc7b7EKv-BVpEIjETlCiBJu4a-E5mR2ccmdo"; 

if (flowUrl === "https://defaultaf73075ee5864d09b8b3d44b758089.52.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/3a0d140e5acc4e259dc83b36923f117c/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=Qn_YOdIgc7b7EKv-BVpEIjETlCiBJu4a-E5mR2ccmdo") {
    alert("Erro: A URL do fluxo (flowUrl) não foi configurada no script do HTML.");
    submitButton.disabled = false;
    submitButton.textContent = 'Enviar para Lançamento';
    return;
}
            
                      // 1. Pegar a lista de arquivos
            const fileInput = document.getElementById('anexoNF');
            const files = fileInput.files;
            const fileInput = document.getElementById('anexoNF');
const files = fileInput.files;

alert("Número de arquivos selecionados: " + files.length); // <-- ADICIONE ESTA LINHA

if (files.length === 0) {
//... o resto do script continua

            if (files.length === 0) {
                alert('Por favor, anexe pelo menos um arquivo da NF.');
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar para Lançamento';
                return;
            }

            // 2. Função auxiliar para ler um arquivo como Base64 (retorna uma Promise)
            function readFileAsBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => {
                        const base64String = reader.result.split(',')[1];
                        resolve({
                            nomeAnexo: file.name,
                            anexoBase64: base64String
                        });
                    };
                    reader.onerror = (error) => reject(error);
                    reader.readAsDataURL(file);
                });
            }

            // 3. Converter TODOS os arquivos para Base64
            const filePromises = [];
            for (let i = 0; i < files.length; i++) {
                filePromises.push(readFileAsBase64(files[i]));
            }

            try {
                // Espera todos os arquivos terminarem a conversão
                const anexosArray = await Promise.all(filePromises);

                // 4. Montar o JSON final (ATUALIZADO com novos campos)
                const formData = {
                    codigoRegistro: document.getElementById('codigoRegistro').value,
                    solicitante: document.getElementById('solicitante').value,
                    unidade: document.getElementById('unidade').value,
                    numeroNF: document.getElementById('numeroNF').value,
                    tipoNF: document.getElementById('tipoNF').value,
                    motivoDevolucao: document.getElementById('motivoDevolucao').value,
                    authTroca: document.getElementById('authTroca').value,
                    codigosMerchan: document.getElementById('codigosMerchan').value,
                    
                    // CAMPOS NOVOS ADICIONADOS AQUI
                    operacaoFiscal: document.getElementById('operacaoFiscal').value,
                    descCoordenador: document.getElementById('descCoordenador').value,

                    // ARRAY DE ANEXOS (para múltiplos arquivos)
                    anexos: anexosArray 
                };

                // 5. Enviar para o Power Automate
                const response = await fetch(flowUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('Solicitação enviada com sucesso!');
                    form.reset(); 
                    submitButton.disabled = false;
                    submitButton.textContent = 'Enviar para Lançamento';
                    document.dispatchEvent(new Event('DOMContentLoaded')); 
                } else {
                    throw new Error('Houve um erro ao enviar. Tente novamente.');
                }

            } catch (error) {
                console.error('Erro:', error);
                alert(error.message);
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar para Lançamento';
            }
        });
    </script>

</body>
</html>
